---
layout: single
title:  "3.Multilinear Regression"
---

## 다중 선형회귀 분석
전에 살펴본 단순선형 회귀 분석에서 독립변수의 개수가 늘어난 형태이다. 그러나, 주의할 점은 단순선형 회귀 분석과 달리 모든 독립 변수 X가 종속 변수 Y와 선형 관계에 있을 필요는 없다.

![Multiple-linear-regression_1 2023-08-29 오후 10.42.48.png](:/998a47abf21c4963aaa8ddf73b682689)

위의 식에서 X1, X2, X3...는 독립변수이고 $\hat{y}$이 예측하는 종속변수, $b_1$, $b_2$, $b_3$는 독립변수들의 상수이다. 
 여기서 만약 예측하는 종속변수를 자동차의 최대 주행속도로, 그리고 변수 X3이 자동차 미러의 크기라고 가정을 해보자. 아무래도 자동차 미러의 크기와 최대 주행 속도는 서로 선형 관계일 가능성이 매우 낮다. 때문에, 이상태에서 학습이 된다면 상수 $b_3$은 0에 가까운 값이 된다. 그러나 그 이외의 변수들(바퀴의 크기, 엔진의 출력 등등..)은 선형 관계일 가능성이 높다. 
 즉 **독립변수들의 조합에 따라서 종속변수 y와의 선형적 관계 여부가 결정된다.** 그렇다면 선형회귀 추정을 하기 위해 변수들이 가져야하는 특별한 조건이 있을까? 

## 선형회귀 추정 /Assumptions of Linear Regression

선형회귀 추정이 가능하기 위해선 다음 조건들을 만족해야 한다.

![Multi-linear-regression_3.png](:/4205e5395b5341808e765e1f9eb79ef7)
**1.선형성** - 당연히 회귀분석을 하려면 독립변수와 종속변수 사이에 선형적인 관계가 있어야 한다

**2.동분산(Homoscedasticity)** - 위의 그림에서 보이듯, 독립변수의 크기에 상관 없이 분산 또는 잔차의 크기가 상수로 일정해야한다. 이를 수식과 표현하면 다음과 같다
$E(u_i)=0$ for all $i$
이를 어기면 이분산(hetroscedasticity)라고 하며 2번 그림의 오른쪽과 같다

**3.다변량 정규성(Multivariate Normality)**
여러 변수로 구성된 dataset도 정규분포의 성질을 띄고 있어야 한다.

**4.독립성**
한 관측치(observation)이 다른 관측치에 영향을 끼쳐서는 안된다는 뜻이다.

**5.다중공선성의 결여(Lack of Multicollinearity)**
독립변수의 일부가 다른 독립변수의 조합으로 표현되면 안된다. 즉, 독립변수들끼리 서로 상관관계가 있으면 안된다.

**6. 극단치 점검(The Outlier Check)**
통계자료의 결과를 왜곡시키거나 분석의 적절성을 위협하는 관측치는 점검해야한다

## 가변수/ Dummy Variable
가변수란 독립변수를 0과 1로 변환하는 변수를 의미하며 범주형 변수를 연속형처럼 만들어서 회귀분석이 가능하게 끔 만들때 사용한다.


![Multi-linear-regression_4 2023-09-03 오전 11.42.26.png](:/2d7d1fa2494b4f2c9eec9d6d482e02b0)

위의 예시에서 State라는 feature를 New York와 California라는 2가지의 값을 갖는 dataset이기에 두 값을 가변수로 만들어 그 value를 0과 1이라는 수로 표현한것이다. 
 여기서, 가변수들을 관찰하면 New York를 1로 표시하면 자동으로 California는 0이라는 것을 알 수 있기에 굳이 California라는 열을 추가 할 필요가 없다. 이는, 강의에서도 강조한 내용이며 $b_5 * D_2$가 여기서 제외된 이유다. 
  그 외에 한가지 의문점을 제기할 수 있는데 그것은 바로 가변수를 추가하면 선형회귀 분석을 하는데 방해가 되지 않냐는 것이다. 왜냐하면 California는 0으로 값이 설정되어 가변수 변수 D1이 0으로 사라지기 때문이다. 이 경우에는 가변수를 원래 독립변수의 값의 개수에 맞게 설정을 해야한다. 즉 New York와 California를 둘다 사용하여 표현을 해야한다는 의미이다.
